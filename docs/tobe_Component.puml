@startuml
title FitLife Web Application Component Diagram

top to bottom direction

!includeurl https://raw.githubusercontent.com/RicardoNiepel/C4-PlantUML/master/C4_Component.puml

Container_Boundary(WarmHouseSystem, "WarmHouse System") {
  Container(Devices, "Devices", "Golang", "Управление устройствами умного дома")
  Container(DataBus, "Data Bus", "Kafka", "Шина данных")
  Container(MetricsCollector, "Metrics Collector", "Golang", "Получает метрики с устройств умного дома")
  ContainerDb(Database, "DevicesDatabase", "PostgreSQL", "Хранит информацию об умных устройствах, а также их метрики")
}

Container(Devices, "Web Application", "Java, Spring") {
  Component(MetricsController, "MetricsController", "Агрегирует и нормализует метрики")
  Component(DevicesController, "DevicesController", "Управляет устройствами")
  Component(ServiceLayer, "Service Layer", "Business logic")
  Component(RepositoryLayer, "Repository Layer", "Data access logic")
}

System_Ext(api, "Smart devices API", "API устройств умного дома")
Container(WebApp, "Web Application", "JS, React", "Изменение состава, управление и просмотр показателей устройств умного дома")

Rel(DevicesController,ServiceLayer,"Calls business logic")
Rel(MetricsController,ServiceLayer,"Calls business logic")
Rel(ServiceLayer,RepositoryLayer,"Reads/Writes data")

Rel(RepositoryLayer,Database,"Чтоение и запись данных")
Rel_R(WebApp, Devices, "Просмотр устройств и метрик")
Rel(DataBus, MetricsController, "Передача данных от прочих сервисов")
Rel(MetricsCollector, DataBus, "Обновление метрик устройств")
Rel(MetricsCollector, api, "Получает и изменяет сосотояние умных устройств")
Rel(DevicesController, api, "Управляет состоянием умных устройств")
@enduml